<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Paulo JerÃ´nimo, 2018-05-20 23:05:41 WEST">
<title>My steps to learn about Spring Cloud Data Flow</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>My steps to learn about Spring Cloud Data Flow</h1>
<div class="details">
<span id="author" class="author">Paulo JerÃ´nimo</span><br>
<span id="email" class="email"><a href="mailto:paulojeronimo@gmail.com">paulojeronimo@gmail.com</a></span><br>
<span id="author2" class="author">2018-05-20 23:05:41 WEST</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_about_this_document">About this document</a></li>
<li><a href="#_about_me">About me</a></li>
</ul>
</li>
<li><a href="#videos">Videos with a technical background</a></li>
<li><a href="#lab1">Lab 1: Quick Start with Docker</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_step_1_download_docker_compose_yml">Step 1 - Download docker-compose.yml</a></li>
<li><a href="#lab1-step2">Step 2 - Start Docker Compose</a></li>
<li><a href="#_step_3_launch_the_spring_cloud_data_flow_dashboard">Step 3 - Launch the Spring Cloud Data Flow Dashboard</a></li>
<li><a href="#_step_4_create_a_stream">Step 4 - Create a Stream</a></li>
<li><a href="#_step_5_verify_that_events_are_being_written_to_the_ticktock_log_every_second">Step 5 - Verify that events are being written to the ticktock log every second</a></li>
<li><a href="#_step_6_delete_a_stream">Step 6 - Delete a Stream</a></li>
<li><a href="#_step_7_destroy_the_quick_start_environment">Step 7 - Destroy the Quick Start environment</a></li>
<li><a href="#_step_8_remove_all_finished_containers">Step 8 -  Remove all finished containers</a></li>
<li><a href="#lab1-step9">Step 9 - Change docker-compose.yml to use RabbitMQ, MySQL and Redis and test it</a></li>
<li><a href="#lab1-conclusions">Conclusions</a></li>
<li><a href="#_references">References</a></li>
</ul>
</li>
<li><a href="#lab2">Lab 2: Run SCDF in PCF Dev</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites_2">Prerequisites</a></li>
<li><a href="#_step_1_download_and_install_pcf_dev">Step 1 - Download and install PCF Dev</a></li>
<li><a href="#_step_2_start_pcf_dev">Step 2 - Start PCF Dev</a></li>
<li><a href="#_step_3_login_into_pcf_dev">Step 3 - Login into PCF Dev</a></li>
<li><a href="#_step_4_create_services">Step 4 - Create services</a></li>
<li><a href="#_step_5_download_some_jars">Step 5 - Download some jars</a></li>
<li><a href="#_step_6_create_a_manifest_yml_file">Step 6 - Create a manifest.yml file</a></li>
<li><a href="#_step_7_push_spring_cloud_dataflow_server_cloudfoundry_to_pcf_dev">Step 7 - Push spring-cloud-dataflow-server-cloudfoundry to PCF Dev</a></li>
<li><a href="#_step_8_access_the_dashboard">Step 8 - Access the dashboard</a></li>
<li><a href="#_step_9_use_the_shell">Step 9 - Use the shell</a></li>
<li><a href="#_step_10_stop_pcf_dev">Step 10 - Stop PCF Dev</a></li>
<li><a href="#_step_11_optional_destroy_the_pcf_dev_environment">Step 11 - (Optional) Destroy the PCF Dev environment</a></li>
<li><a href="#lab2-conclusions">Conclusions</a></li>
<li><a href="#_references_2">References</a></li>
</ul>
</li>
<li><a href="#lab3">Lab 3: Creating a custom processor application</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites_3">Prerequisites</a></li>
<li><a href="#lab3-step1">Step 1 - Create a rabbitmq Docker container</a></li>
<li><a href="#_step_2_download_and_start_manually_sources_and_sinks">Step 2 - Download and start, manually, sources and sinks</a></li>
<li><a href="#_step_3_create_and_run_a_new_processor_manually">Step 3 - Create and run a new processor manually</a></li>
<li><a href="#_step_4_run_the_new_processor_using_spring_cloud_dataflow_server_local">Step 4 - Run the new processor using spring-cloud-dataflow-server-local</a></li>
<li><a href="#_step_5_stop_and_destroy_rabbitmq_container">Step 5 - Stop and destroy rabbitmq container</a></li>
<li><a href="#lab3-conclusions">Conclusions</a></li>
<li><a href="#_references_3">References</a></li>
</ul>
</li>
<li><a href="#lab4">Lab 4: Setting up a Windows environment to develop with SCDF</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites_4">Prerequisites</a></li>
<li><a href="#_step_1_creating_of_user1">Step 1 - Creating of user1</a></li>
<li><a href="#_step_2_gitbash_installation">Step 2 - GitBash installation</a></li>
<li><a href="#_step_3_java_development_kit_installation">Step 3 - Java Development Kit installation</a></li>
<li><a href="#_step_4_rabbitmq_installation">Step 4 - RabbitMQ installation</a></li>
<li><a href="#_step_5_download_this_repository">Step 5 - Download this repository</a></li>
</ul>
</li>
<li><a href="#lab5">Lab 5: Connecting a source to a sink using Spring Cloud Stream</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites_5">Prerequisites</a></li>
<li><a href="#_step_1_download_some_spring_cloud_stream_apps">Step 1 - Download some Spring Cloud Stream Apps</a></li>
<li><a href="#_step_2_start_http_source_rabbit">Step 2 - Start http-source-rabbit</a></li>
<li><a href="#_step_3_start_log_sink_rabbit">Step 3 - Start log-sink-rabbit</a></li>
<li><a href="#_step_4_send_a_post_request_and_get_a_result">Step 4 - Send a POST request and get a result</a></li>
<li><a href="#_notes_conclusions">Notes/conclusions</a></li>
</ul>
</li>
<li><a href="#lab6">Lab 6: Manually using SCDF (server local/shell)</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites_6">Prerequisites</a></li>
<li><a href="#_step_1_download_spring_cloud_data_flow_jars_server_local_and_shell">Step 1 - Download Spring Cloud Data Flow jars (server-local and shell)</a></li>
<li><a href="#_step_2_start_spring_cloud_data_flow_server_local_and_shell">Step 2 - Start Spring Cloud Data Flow (server-local and shell)</a></li>
<li><a href="#_step_3_register_applications_create_and_deploy_a_stream">Step 3 - Register applications, create and deploy a stream</a></li>
<li><a href="#_step_4_monitor_the_stream_log">Step 4 - Monitor the stream log</a></li>
<li><a href="#_step_5_accessing_the_graphical_ui_dashboard">Step 5 - Accessing the Graphical UI Dashboard</a></li>
<li><a href="#_step_6_inspecting_the_tabs">Step 6 - Inspecting the tabs</a></li>
<li><a href="#_step_7_backing_to_the_shell">Step 7 - Backing to the shell</a></li>
</ul>
</li>
<li><a href="#lab7">Lab 7: Importing existing sources, sinks, processors and tasks to SCDF</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites_7">Prerequisites</a></li>
<li><a href="#_steps">Steps</a></li>
<li><a href="#_notes_conclusions_2">Notes/conclusions</a></li>
</ul>
</li>
<li><a href="#_all_references">All references</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Recently I had work to produce a document with a comparison between two tools for Cloud Data Flow.
I didn&#8217;t have any knowledge of this kind of technology before creating this document.
<a href="https://github.com/spring-cloud/spring-cloud-dataflow">Spring Cloud Data Flow</a> (SCDF) is one of the tools in my comparison document.
So, here I describe my own procedures to learn about SCDF and take my own preliminary conclusions.
I followed many steps on my own desktop (a MacBook Pro computer) to accomplish this task.
This document shows you what I did.</p>
</div>
<div class="paragraph">
<p>Basically, to learn about SCDF in order to do a comparison with other tool:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I saw some <a href="#videos">videos</a> about it.</p>
</li>
<li>
<p>I wrote my own labs:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#lab1">Quick Start with Docker</a></p>
</li>
<li>
<p><a href="#lab2">Run SCDF in PCF Dev</a></p>
</li>
<li>
<p><a href="#lab3">Creating a custom processor application</a></p>
</li>
<li>
<p><a href="#lab4">Setting up a Windows environment to develop with SCDF</a></p>
</li>
<li>
<p><a href="#lab5">Connecting a source to a sink using Spring Cloud Stream</a></p>
</li>
<li>
<p><a href="#lab6">Manually using SCDF (server local/shell)</a></p>
</li>
<li>
<p><a href="#lab7">Importing existing sources, sinks, processors and tasks to SCDF</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these labs, I only used command line tools.
This approach was very simple for me because I have to much experience in tools like Bash and GNU commands.
I didnÂ´t use any IDE (like <a href="https://spring.io/tools">Spring Tool Suite</a>).
I know that this could make all the process even simpler for developers without command line experience.
But, my focus was on the technologies itself.
So for me, a command line approach showed me in deeper concepts that I wanted to learn.</p>
</div>
<div class="sect2">
<h3 id="_about_this_document">About this document</h3>
<div class="paragraph">
<p>This document was written using <a href="https://www.vim.org">Vim</a> (my favorite text editor) and its <a href="https://github.com/paulojeronimo/spring-cloud-dataflow-tutorial">source code</a> is in <a href="https://asciidoctor.org/docs/asciidoc-syntax-quick-reference/">AsciiDoc</a> format.
The generated output formats (HTML and PDF) are build (and published in <a href="https://pages.github.com">GitHub Pages</a>) with <a href="https://gradle.com">Gradle</a>.
Read more about the generation processes of this document in <a href="https://github.com/paulojeronimo/spring-cloud-dataflow-tutorial/blob/master/README.adoc">README.adoc</a>.</p>
</div>
<div class="paragraph">
<p>Download the <a href="https://paulojeronimo.github.io/spring-cloud-dataflow-tutorial/spring-cloud-dataflow-tutorial.pdf">PDF version of this document</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_about_me">About me</h3>
<div class="paragraph">
<p>You can read more about me on <a href="http://paulojeronimo.github.io/cv/en/">my cv</a>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="videos">Videos with a technical background</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Prior to starting my own labs, I saw some introductory videos (available on YouTube):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.youtube.com/watch?v=8cqztXVPy6c" target="_blank" rel="noopener">SCDF</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=Z6_ttC33N0U" target="_blank" rel="noopener">Webinar Data Microservices with Spring Cloud Data Flow</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=GqEsgLUwskY" target="_blank" rel="noopener">Orchestrating Data Microservices with Spring Cloud Data Flow - Mark Pollack</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These was the first videos that introduce me the basic concepts.
After that, I also <a href="#all-videos">saw many other videos</a> (many times).</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="lab1">Lab 1: Quick Start with Docker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For me, the best way to start learning a new technology is by running all the stuff related to them inside a <a href="https://www.docker.com/">Docker</a> container.
By this way, I can abstract myself about the related installation procedures and go directly to the point.</p>
</div>
<div class="paragraph">
<p>So, I started my labs by following the steps on the <a href="https://cloud.spring.io/spring-cloud-dataflow">Quick Start page</a>.
These steps use Docker and <a href="https://docs.docker.com/compose/">Docker Compose</a>.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites">Prerequisites</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://www.docker.com/">Docker</a> installed.</p>
</li>
<li>
<p><a href="https://docs.docker.com/compose/">Docker Compose</a> installed.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_download_docker_compose_yml">Step 1 - Download docker-compose.yml</h3>
<div class="paragraph">
<p>My first steps were create a working directory and download the <code>docker-compose.yml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir -p ~/labs/spring-cloud-dataflow &amp;&amp; cd $_

$ wget -c https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v1.4.0.RELEASE/spring-cloud-dataflow-server-local/docker-compose.yml</pre>
</div>
</div>
<div class="paragraph">
<p>By default, this file is configured to use <a href="https://kafka.apache.org/">Kafka</a> and <a href="https://zookeeper.apache.org/">Zookeeper</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cat docker-compose.yml
version: '3'

services:
  kafka:
    image: wurstmeister/kafka:0.10.1.0
    expose:
      - "9092"
    environment:
      - KAFKA_ADVERTISED_PORT=9092
      - KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
    depends_on:
      - zookeeper
  zookeeper:
    image: wurstmeister/zookeeper
    expose:
      - "2181"
    environment:
      - KAFKA_ADVERTISED_HOST_NAME=zookeeper
  dataflow-server:
    image: springcloud/spring-cloud-dataflow-server-local:1.4.0.RELEASE
    container_name: dataflow-server
    ports:
      - "9393:9393"
    environment:
      - spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.brokers=kafka:9092
      - spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.zkNodes=zookeeper:2181
    depends_on:
      - kafka
  app-import:
    image: alpine:3.7
    depends_on:
      - dataflow-server
    command: &gt;
      /bin/sh -c "
        while ! nc -z dataflow-server 9393;
        do
          sleep 1;
        done;
        wget -qO- 'http://dataflow-server:9393/apps' --post-data='uri=http://bit.ly/Celsius-SR1-stream-applications-kafka-10-maven&amp;force=true';
        echo 'Stream apps imported'
        wget -qO- 'http://dataflow-server:9393/apps'  --post-data='uri=http://bit.ly/Clark-GA-task-applications-maven&amp;force=true';
        echo 'Task apps imported'"</pre>
</div>
</div>
<div class="paragraph">
<p>I could also change these settings to use <a href="https://www.rabbitmq.com/">RabbitMQ</a>, <a href="https://www.mysql.com/">MySQL</a>, and <a href="https://redis.io/">Redis</a>.
I show you how to do this in the <a href="#lab1-step9">step 9</a> of this lab.</p>
</div>
</div>
<div class="sect2">
<h3 id="lab1-step2">Step 2 - Start Docker Compose</h3>
<div class="paragraph">
<p>I started <code>docker-compose</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker-compose up</pre>
</div>
</div>
<div class="paragraph">
<p>The above command downloaded all the necessary Docker images (configured in <code>docker-compose.yml</code> file).
After that, it also created and started the containers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The current shell remains blocked until we stop <code>docker-compose</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_launch_the_spring_cloud_data_flow_dashboard">Step 3 - Launch the Spring Cloud Data Flow Dashboard</h3>
<div class="paragraph">
<p>I opened the dashboard at <a href="http://localhost:9393/dashboard" class="bare">http://localhost:9393/dashboard</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_create_a_stream">Step 4 - Create a Stream</h3>
<div class="paragraph">
<p>I did some steps in the UI of the dashboard.</p>
</div>
<div class="paragraph">
<p>I used <code>Create Stream</code> under <code>Streams</code> tab to define and deploy a stream <code>time | log</code> called <code>ticktock</code>.
This was done in two steps:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/01.png" alt="01">
</div>
<div class="title">Figure 1. Step 4.1</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/02.png" alt="02">
</div>
<div class="title">Figure 2. Step 4.2</div>
</div>
<div class="paragraph">
<p>After that, the <code>ticktock</code> stream was deployed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/03.png" alt="03">
</div>
<div class="title">Figure 3. Step 4.3</div>
</div>
<div class="paragraph">
<p>Two running stream apps appears under <code>Runtime</code> tab:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/04.png" alt="04">
</div>
<div class="title">Figure 4. Step 4.4</div>
</div>
<div class="paragraph">
<p>Then I clicked on <code>ticktock.log</code> to determine the location of the stdout log file.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/05.png" alt="05">
</div>
<div class="title">Figure 5. Step 4.5</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_verify_that_events_are_being_written_to_the_ticktock_log_every_second">Step 5 - Verify that events are being written to the ticktock log every second</h3>
<div class="listingblock">
<div class="content">
<pre>$ log=/tmp/spring-cloud-deployer-5011048283762989937/ticktock-1524755341440/ticktock.log/stdout_0.log
$ tail -f $log</pre>
</div>
</div>
<div class="paragraph">
<p>This last step did not work <span class="icon"><i class="fa fa-bomb"></i></span>.
Obvious (I thinked) &#8230;&#8203; the above file is inside the container!
So I started to investigate how to read this file by using Docker reading the <a href="https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/">Spring Cloud Data Flow Reference Guide</a> and yes, in that, I found the solution to type the correct command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ docker exec -it dataflow-server tail -f $log</pre>
</div>
</div>
<div id="lab1-negative-1" class="paragraph">
<p>My conclusion was: the <a href="https://cloud.spring.io/spring-cloud-dataflow">Quick Start page</a> needs to be fixed (on this step) to present the above command correctly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_delete_a_stream">Step 6 - Delete a Stream</h3>
<div class="imageblock">
<div class="content">
<img src="images/06.png" alt="06">
</div>
<div class="title">Figure 6. Step 6.1</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/07.png" alt="07">
</div>
<div class="title">Figure 7. Step 6.2</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_destroy_the_quick_start_environment">Step 7 - Destroy the Quick Start environment</h3>
<div class="paragraph">
<p>I opened another shell and typed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker-compose down</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_remove_all_finished_containers">Step 8 -  Remove all finished containers</h3>
<div class="paragraph">
<p>To remove all finished containers, I did:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker ps -a | grep Exit | cut -d ' ' -f 1 | xargs sudo docker rm</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lab1-step9">Step 9 - Change docker-compose.yml to use RabbitMQ, MySQL and Redis and test it</h3>
<div class="paragraph">
<p>In order to change the contents of <code>docker-compose.yml</code> I cloned the repository of this tutorial:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git clone https://github.com/paulojeronimo/spring-cloud-dataflow-tutorial tutorial</pre>
</div>
</div>
<div class="paragraph">
<p>After download this repository, I applied a patch on <code>docker-compose.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ patch docker-compose.yml &lt; tutorial/files/docker-compose.yml.patch</pre>
</div>
</div>
<div class="paragraph">
<p>This is the contents of the file <code>docker-compose.yml.patch</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-diff" data-lang="diff">--- docker-compose.yml.original	2018-05-01 00:35:11.000000000 +0100
+++ docker-compose.yml	2018-05-01 00:44:49.000000000 +0100
@@ -1,31 +1,38 @@
 version: '3'

 services:
-  kafka:
-    image: wurstmeister/kafka:0.10.1.0
+  rabbitmq:
+    image: rabbitmq:3.7
     expose:
-      - "9092"
+      - "5672"
+  mysql:
+    image: mariadb:10.2
     environment:
-      - KAFKA_ADVERTISED_PORT=9092
-      - KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
-    depends_on:
-      - zookeeper
-  zookeeper:
-    image: wurstmeister/zookeeper
+      MYSQL_DATABASE: dataflow
+      MYSQL_USER: root
+      MYSQL_ROOT_PASSWORD: rootpw
     expose:
-      - "2181"
-    environment:
-      - KAFKA_ADVERTISED_HOST_NAME=zookeeper
+      - 3306
+  redis:
+    image: redis:2.8
+    expose:
+      - "6379"
   dataflow-server:
     image: springcloud/spring-cloud-dataflow-server-local:1.4.0.RELEASE
     container_name: dataflow-server
     ports:
       - "9393:9393"
     environment:
-      - spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.brokers=kafka:9092
-      - spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.zkNodes=zookeeper:2181
+      - spring_datasource_url=jdbc:mysql://mysql:3306/dataflow
+      - spring_datasource_username=root
+      - spring_datasource_password=rootpw
+      - spring_datasource_driver-class-name=org.mariadb.jdbc.Driver
+      - spring.cloud.dataflow.applicationProperties.stream.spring.rabbitmq.host=rabbitmq
+      - spring.cloud.dataflow.applicationProperties.stream.spring.redis.host=redis
+      - spring_redis_host=redis
     depends_on:
-      - kafka
+      - rabbitmq
+      - mysql
   app-import:
     image: alpine:3.7
     depends_on:
@@ -36,7 +43,7 @@
         do
           sleep 1;
         done;
-        wget -qO- 'http://dataflow-server:9393/apps' --post-data='uri=http://bit.ly/Celsius-SR1-stream-applications-kafka-10-maven&amp;force=true';
+        wget -qO- 'http://dataflow-server:9393/apps' --post-data='uri=http://bit.ly/Celsius-SR1-stream-applications-rabbit-maven&amp;force=true';
         echo 'Stream apps imported'
         wget -qO- 'http://dataflow-server:9393/apps'  --post-data='uri=http://bit.ly/Clark-GA-task-applications-maven&amp;force=true';
         echo 'Task apps imported'"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now I could repeat the steps from this tutorial beggining from <a href="#lab1-step2">step 2</a>.</p>
</div>
<div class="paragraph">
<p>More details about the configuration that I made in <code>docker-compose.yml</code> throught the use of of my patch can be found in <a href="https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/#getting-started-customizing-spring-cloud-dataflow-docker">"Docker Compose Customization"</a> on <a href="https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/">Spring Cloud Data Flow Reference Guide</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="lab1-conclusions">Conclusions</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Positive points: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The Docker configuration to run SCDF is well done and absolutely finished.
I did not have to do anything to quickly get things running.</p>
</li>
<li>
<p>Running SCDF on Docker on my machine was extremely fast.</p>
</li>
<li>
<p>Using Docker Compose, the switching from Kafka to RabbitMQ was quite simple (after I resolve a problem with a non documented step).</p>
</li>
<li>
<p>The UI interface (provided by the dashboard) is pretty simple.
All sources, sinks, and processors are elements that could be configured through the UI.
The stream creation using the UI is very basic (for me this is nice) but can also be configured.</p>
<div class="ulist">
<ul>
<li>
<p>Even though I have not done configurations on elements of UI, a good video that shows how to do this is <a href="https://www.youtube.com/watch?v=78CgV46OstI" target="_blank" rel="noopener">Spring Flo for Spring Cloud Data Flow1.0.0M3</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Negative points: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://cloud.spring.io/spring-cloud-dataflow">Quick Start page</a> that I used to follow steps has a bug <a href="#lab1-negative-1">like I said</a>.</p>
</li>
<li>
<p>Even the <a href="https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/">Spring Cloud Data Flow Reference Guide</a> has some missed points that I had to discover myself.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_references">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://cloud.spring.io/spring-cloud-dataflow">Quick Start page</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/">Spring Cloud Data Flow Reference Guide</a></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lab2">Lab 2: Run SCDF in PCF Dev</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By doing this lab, my intention was to discover if it was easy to create an infrastructure prepared to run SCDF in <a href="https://run.pivotal.io/">Pivotal Cloud Foundry</a>.
Also, one of my goals was to switch from <a href="https://kafka.apache.org/">Kafka</a> to <a href="https://www.rabbitmq.com/">RabbitMQ</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To start this lab, in order to have sufficient memory for executing the following steps, I had to quit Docker.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_prerequisites_2">Prerequisites</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#lab1">Lab 1</a> executed.</p>
</li>
<li>
<p><a href="https://www.virtualbox.org/">VirtualBox</a> installed (PCF Dev uses it).</p>
</li>
<li>
<p>An account on <a href="https://run.pivotal.io/">Pivotal Web Services</a> (do download PCF Dev binary).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_download_and_install_pcf_dev">Step 1 - Download and install PCF Dev</h3>
<div class="paragraph">
<p>First of all, after I downloaded the <a href="https://network.pivotal.io/products/pcfdev">PCF Dev binary</a>, I typed the following commands to install it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ unzip pcfdev-v0.30.0+PCF1.11.0-osx.zip
Archive:  pcfdev-v0.30.0+PCF1.11.0-osx.zip
  inflating: pcfdev-v0.30.0+PCF1.11.0-osx

$ ./pcfdev-v0.30.0+PCF1.11.0-osx
Plugin successfully upgraded. Current version: 0.30.0. For more info run: cf dev help</pre>
</div>
</div>
<div class="paragraph">
<p>To check the current version, I typed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf dev version
PCF Dev version 0.30.0 (CLI: 850ae45, OVA: 0.549.0)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_start_pcf_dev">Step 2 - Start PCF Dev</h3>
<div class="paragraph">
<p>I started PCF Dev with more memory than default (4096 MB makes the services very hard to work):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf dev start -m 8192
Downloading VM...
Progress: |====================&gt;| 100%
VM downloaded.
Allocating 8192 MB out of 16384 MB total system memory (9217 MB free).
Importing VM...
Starting VM...
Provisioning VM...
Waiting for services to start...
7 out of 58 running
7 out of 58 running
7 out of 58 running
7 out of 58 running
40 out of 58 running
56 out of 58 running
58 out of 58 running
 _______  _______  _______    ______   _______  __   __
|       ||       ||       |  |      | |       ||  | |  |
|    _  ||       ||    ___|  |  _    ||    ___||  |_|  |
|   |_| ||       ||   |___   | | |   ||   |___ |       |
|    ___||      _||    ___|  | |_|   ||    ___||       |
|   |    |     |_ |   |      |       ||   |___  |     |
|___|    |_______||___|      |______| |_______|  |___|
is now running.
To begin using PCF Dev, please run:
   cf login -a https://api.local.pcfdev.io --skip-ssl-validation
Apps Manager URL: https://apps.local.pcfdev.io
Admin user =&gt; Email: admin / Password: admin
Regular user =&gt; Email: user / Password: pass</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The command above takes some time (around 15 minutes on my MacBook Pro) because it has to download the VM (in <a href="https://en.wikipedia.org/wiki/Open_Virtualization_Format">OVA format</a>) and starts a bunch of services (the most time-consuming part of the procedure).
After it finishes I verified the directory structure where the machine was installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ tree ~/.pcfdev/
/Users/pj/.pcfdev/
|-- ova
|   `-- pcfdev-v0.549.0.ova
|-- token
`-- vms
    |-- key.pem
    |-- pcfdev-v0.549.0
    |   |-- Logs
    |   |   |-- VBox.log
    |   |   `-- VBox.log.1
    |   |-- pcfdev-v0.549.0-disk1.vmdk
    |   |-- pcfdev-v0.549.0.vbox
    |   `-- pcfdev-v0.549.0.vbox-prev
    `-- vm_config

4 directories, 9 files</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_login_into_pcf_dev">Step 3 - Login into PCF Dev</h3>
<div class="paragraph">
<p>When PCF Dev was started, I made my login:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf login -a https://api.local.pcfdev.io --skip-ssl-validation -u admin -p admin -o pcfdev-org
API endpoint: https://api.local.pcfdev.io
Authenticating...
OK

Targeted org pcfdev-org

Targeted space pcfdev-space



API endpoint:   https://api.local.pcfdev.io (API version: 2.82.0)
User:           admin
Org:            pcfdev-org
Space:          pcfdev-space</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_create_services">Step 4 - Create services</h3>
<div class="paragraph">
<p>After that, I created three services:</p>
</div>
<div class="paragraph">
<p><a href="https://www.mysql.com/">MySQL</a> service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf create-service p-mysql 512mb df-mysql
Creating service instance df-mysql in org pcfdev-org / space pcfdev-space as admin...
OK</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://www.rabbitmq.com/">RabbitMQ</a> service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf create-service p-rabbitmq standard df-rabbitmq
Creating service instance df-rabbitmq in org pcfdev-org / space pcfdev-space as admin...
OK</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://redis.io/">Redis</a> service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf create-service p-redis shared-vm df-redis
Creating service instance df-redis in org pcfdev-org / space pcfdev-space as admin...
OK</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_download_some_jars">Step 5 - Download some jars</h3>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/labs/spring-cloud-dataflow
$ wget -c http://repo.spring.io/release/org/springframework/cloud/spring-cloud-dataflow-server-cloudfoundry/1.4.0.RELEASE/spring-cloud-dataflow-server-cloudfoundry-1.4.0.RELEASE.jar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_create_a_manifest_yml_file">Step 6 - Create a manifest.yml file</h3>
<div class="paragraph">
<p>I copied <code>tutorial/file/manifest.yml</code> file to the current dir:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cp ../tutorial/files/manifest.yml .</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>tutorial</code> dir was created on <a href="#lab1-step9">lab 1, step 9</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The content of this file is presented below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">---
applications:
- name: dataflow-server
  memory: 2g
  disk_quota: 2g
  path: spring-cloud-dataflow-server-cloudfoundry-1.4.0.RELEASE.jar
  buildpack: java_buildpack
  services:
    - df-mysql
    - df-redis
  env:
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_URL: https://api.local.pcfdev.io
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_ORG: pcfdev-org
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_SPACE: pcfdev-space
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_DOMAIN: local.pcfdev.io
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_SERVICES: df-rabbitmq
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_USERNAME: admin
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_PASSWORD: admin
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_SKIP_SSL_VALIDATION: true
    MAVEN_REMOTE_REPOSITORIES_REPO1_URL: https://repo.spring.io/libs-snapshot
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_MEMORY: 512
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_DISK: 512
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_INSTANCES: 1
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_BUILDPACK: java_buildpack
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_ENABLE_RANDOM_APP_NAME_PREFIX: false
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_SERVICES: df-mysql
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_MEMORY: 512
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_DISK: 512
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_INSTANCES: 1
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_BUILDPACK: java_buildpack
    SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_ENABLE_RANDOM_APP_NAME_PREFIX: false
    SPRING_CLOUD_DATAFLOW_FEATURES_EXPERIMENTAL_TASKSENABLED: true</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The session <a href="http://docs.spring.io/spring-cloud-dataflow-server-cloudfoundry/docs/1.4.0.RELEASE/reference/htmlsingle/#getting-started-cloudfoundry-deploying-using-manifest">"Deploying using a Manifest"</a> of the document <a href="http://docs.spring.io/spring-cloud-dataflow-server-cloudfoundry/docs/1.4.0.RELEASE/reference/htmlsingle">"Spring Cloud Data Flow Server for Cloud Foundry"</a> details this file.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_push_spring_cloud_dataflow_server_cloudfoundry_to_pcf_dev">Step 7 - Push spring-cloud-dataflow-server-cloudfoundry to PCF Dev</h3>
<div class="listingblock">
<div class="content">
<pre>$ cf push
Pushing from manifest to org pcfdev-org / space pcfdev-space as admin...
Using manifest file /Users/pj/labs/spring-cloud-dataflow/manifest.yml
Getting app info...
Creating app with these attributes...
+ name:         dataflow-server
  path:         /Users/pj/labs/spring-cloud-dataflow/spring-cloud-dataflow-server-cloudfoundry-1.4.0.RELEASE.jar
+ buildpack:    java_buildpack
+ disk quota:   2G
+ memory:       2G
  services:
+   df-mysql
+   df-redis
  env:
+   MAVEN_REMOTE_REPOSITORIES_REPO1_URL
+   SPRING_CLOUD_DATAFLOW_FEATURES_EXPERIMENTAL_TASKSENABLED
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_DOMAIN
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_ORG
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_PASSWORD
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_SKIP_SSL_VALIDATION
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_SPACE
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_BUILDPACK
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_DISK
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_ENABLE_RANDOM_APP_NAME_PREFIX
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_INSTANCES
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_MEMORY
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_STREAM_SERVICES
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_BUILDPACK
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_DISK
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_ENABLE_RANDOM_APP_NAME_PREFIX
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_INSTANCES
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_MEMORY
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_TASK_SERVICES
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_URL
+   SPRING_CLOUD_DEPLOYER_CLOUDFOUNDRY_USERNAME
  routes:
+   dataflow-server.local.pcfdev.io

Creating app dataflow-server...
Mapping routes...
Binding services...
Comparing local files to remote cache...
Packaging files to upload...
Uploading files...
 71.59 MiB / 71.59 MiB [==========================================================================================================================] 100.00% 2s

Waiting for API to complete processing files...

Staging app and tracing logs...
   Downloading java_buildpack...
   Downloaded java_buildpack (244.5M)
   Creating container
   Successfully created container
   Downloading app package...
   Downloaded app package (71.6M)
   Staging...
   -----&gt; Java Buildpack Version: v3.13 (offline) | https://github.com/cloudfoundry/java-buildpack.git#03b493f
   -----&gt; Downloading Open Jdk JRE 1.8.0_121 from https://java-buildpack.cloudfoundry.org/openjdk/trusty/x86_64/openjdk-1.8.0_121.tar.gz (found in cache)
          Expanding Open Jdk JRE to .java-buildpack/open_jdk_jre (1.0s)
   -----&gt; Downloading Open JDK Like Memory Calculator 2.0.2_RELEASE from https://java-buildpack.cloudfoundry.org/memory-calculator/trusty/x86_64/memory-calculator-2.0.2_RELEASE.tar.gz (found in cache)
          Memory Settings: -Xmx1363148K -XX:MaxMetaspaceSize=209715K -Xms1363148K -XX:MetaspaceSize=209715K -Xss699K
   -----&gt; Downloading Container Certificate Trust Store 2.0.0_RELEASE from https://java-buildpack.cloudfoundry.org/container-certificate-trust-store/container-certificate-trust-store-2.0.0_RELEASE.jar (found in cache)
          Adding certificates to .java-buildpack/container_certificate_trust_store/truststore.jks (0.4s)
   -----&gt; Downloading Spring Auto Reconfiguration 1.10.0_RELEASE from https://java-buildpack.cloudfoundry.org/auto-reconfiguration/auto-reconfiguration-1.10.0_RELEASE.jar (found in cache)
   Exit status 0
   Staging complete
   Uploading droplet, build artifacts cache...
   Uploading build artifacts cache...
   Uploading droplet...
   Uploaded build artifacts cache (108B)
   Uploaded droplet (116.9M)
   Uploading complete
   Destroying container
   Successfully destroyed container

Waiting for app to start...

name:              dataflow-server
requested state:   started
instances:         1/1
usage:             2G x 1 instances
routes:            dataflow-server.local.pcfdev.io
last uploaded:     Tue 01 May 19:48:22 WEST 2018
stack:             cflinuxfs2
buildpack:         java_buildpack
start command:     CALCULATED_MEMORY=$($PWD/.java-buildpack/open_jdk_jre/bin/java-buildpack-memory-calculator-2.0.2_RELEASE
                   -memorySizes=metaspace:64m..,stack:228k.. -memoryWeights=heap:65,metaspace:10,native:15,stack:10 -memoryInitials=heap:100%,metaspace:100%
                   -stackThreads=300 -totMemory=$MEMORY_LIMIT) &amp;&amp; JAVA_OPTS="-Djava.io.tmpdir=$TMPDIR
                   -XX:OnOutOfMemoryError=$PWD/.java-buildpack/open_jdk_jre/bin/killjava.sh $CALCULATED_MEMORY
                   -Djavax.net.ssl.trustStore=$PWD/.java-buildpack/container_certificate_trust_store/truststore.jks
                   -Djavax.net.ssl.trustStorePassword=java-buildpack-trust-store-password" &amp;&amp; SERVER_PORT=$PORT eval exec
                   $PWD/.java-buildpack/open_jdk_jre/bin/java $JAVA_OPTS -cp $PWD/. org.springframework.boot.loader.JarLauncher

     state     since                  cpu      memory         disk         details
#0   running   2018-05-01T18:49:23Z   220.0%   782.6M of 2G   206M of 2G</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_access_the_dashboard">Step 8 - Access the dashboard</h3>
<div class="paragraph">
<p>After deployed, I pointed my browser to to following URL: <a href="http://dataflow-server.local.pcfdev.io/dashboard/" class="bare">http://dataflow-server.local.pcfdev.io/dashboard/</a>.</p>
</div>
<div class="paragraph">
<p>I noticed that the dashboard gives me a information that it has no applications installed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_9_use_the_shell">Step 9 - Use the shell</h3>
<div class="paragraph">
<p>In my <a href="#lab1">previous lab</a>, I used the UI interface (through the browser) to create a stream.
This time, however, I created the stream by using the command line.
These were my steps:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ wget -c http://repo.spring.io/release/org/springframework/cloud/spring-cloud-dataflow-shell/1.4.0.RELEASE/spring-cloud-dataflow-shell-1.4.0.RELEASE.jar</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar spring-cloud-dataflow-shell-1.4.0.RELEASE.jar
  ____                              ____ _                __
 / ___| _ __  _ __(_)_ __   __ _   / ___| | ___  _   _  __| |
 \___ \| '_ \| '__| | '_ \ / _` | | |   | |/ _ \| | | |/ _` |
  ___) | |_) | |  | | | | | (_| | | |___| | (_) | |_| | (_| |
 |____/| .__/|_|  |_|_| |_|\__, |  \____|_|\___/ \__,_|\__,_|
  ____ |_|    _          __|___/                 __________
 |  _ \  __ _| |_ __ _  |  ___| | _____      __  \ \ \ \ \ \
 | | | |/ _` | __/ _` | | |_  | |/ _ \ \ /\ / /   \ \ \ \ \ \
 | |_| | (_| | || (_| | |  _| | | (_) \ V  V /    / / / / / /
 |____/ \__,_|\__\__,_| |_|   |_|\___/ \_/\_/    /_/_/_/_/_/

1.4.0.RELEASE

Welcome to the Spring Cloud Data Flow shell. For assistance hit TAB or type "help".
server-unknown:&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>I configured the shell to access my local PCF Dev instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server-unknown:&gt;dataflow config server http://dataflow-server.local.pcfdev.io
Shell mode: classic, Server mode: classic
dataflow:&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>I imported the applications:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dataflow:&gt;app import --uri http://bit.ly/Celsius-SR1-stream-applications-rabbit-maven
Successfully registered 65 applications from [source.sftp, source.mqtt.metadata, sink.mqtt.metadata, source.file.metadata, processor.tcp-client, source.s3.metadata, source.jms, source.ftp, processor.transform.metadata, source.time, sink.mqtt, sink.s3.metadata, processor.scriptable-transform, sink.log, source.load-generator, processor.transform, source.syslog, sink.websocket.metadata, sink.task-launcher-local.metadata, source.loggregator.metadata, source.s3, source.load-generator.metadata, processor.pmml.metadata, source.loggregator, source.tcp.metadata, processor.httpclient.metadata, sink.file.metadata, source.triggertask, source.twitterstream, source.gemfire-cq.metadata, processor.aggregator.metadata, source.mongodb, source.time.metadata, source.gemfire-cq, sink.counter.metadata, source.http, sink.tcp.metadata, sink.pgcopy.metadata, source.rabbit, sink.task-launcher-yarn, source.jms.metadata, sink.gemfire.metadata, sink.cassandra.metadata, processor.tcp-client.metadata, processor.header-enricher, sink.throughput, sink.task-launcher-local, processor.python-http, sink.aggregate-counter.metadata, sink.mongodb, processor.twitter-sentiment, sink.log.metadata, processor.splitter, sink.hdfs-dataset, source.tcp, processor.python-jython.metadata, source.trigger, source.mongodb.metadata, processor.bridge, source.http.metadata, source.rabbit.metadata, sink.ftp, sink.jdbc, source.jdbc.metadata, source.mqtt, processor.pmml, sink.aggregate-counter, sink.rabbit.metadata, processor.python-jython, sink.router.metadata, sink.cassandra, processor.filter.metadata, source.tcp-client.metadata, processor.header-enricher.metadata, processor.groovy-transform, source.ftp.metadata, sink.router, sink.redis-pubsub, source.tcp-client, processor.httpclient, sink.file, sink.websocket, source.syslog.metadata, sink.s3, sink.counter, sink.rabbit, processor.filter, source.trigger.metadata, source.mail.metadata, sink.gpfdist.metadata, sink.pgcopy, processor.python-http.metadata, sink.jdbc.metadata, sink.gpfdist, sink.ftp.metadata, processor.splitter.metadata, sink.sftp, sink.field-value-counter, processor.groovy-filter.metadata, processor.twitter-sentiment.metadata, source.triggertask.metadata, sink.hdfs, processor.groovy-filter, sink.redis-pubsub.metadata, source.sftp.metadata, processor.bridge.metadata, sink.field-value-counter.metadata, processor.groovy-transform.metadata, processor.aggregator, sink.sftp.metadata, processor.tensorflow.metadata, sink.throughput.metadata, sink.hdfs-dataset.metadata, sink.tcp, source.mail, sink.task-launcher-cloudfoundry.metadata, source.gemfire.metadata, processor.tensorflow, source.jdbc, sink.task-launcher-yarn.metadata, sink.gemfire, source.gemfire, source.twitterstream.metadata, sink.hdfs.metadata, processor.tasklaunchrequest-transform, sink.task-launcher-cloudfoundry, source.file, sink.mongodb.metadata, processor.tasklaunchrequest-transform.metadata, processor.scriptable-transform.metadata]</pre>
</div>
</div>
<div class="paragraph">
<p>I refresh my browser and noticed that, now, I had many applications installed (65 according to the last log).</p>
</div>
<div class="paragraph">
<p>I created the stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dataflow:&gt;stream create --name httptest --definition "http | log" --deploy
Created new stream 'httptest'
Deployment request has been sent</pre>
</div>
</div>
<div class="paragraph">
<p>I noticed that the stream was deployed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dataflow:&gt;stream list
âââââââââââââ¤ââââââââââââââââââ¤ââââââââââââââââââââââââââââââââââââââââââ
âStream NameâStream Definitionâ                 Status                  â
â ââââââââââââªââââââââââââââââââªââââââââââââââââââââââââââââââââââââââââââ£
âhttptest   âhttp | log       âThe stream has been successfully deployedâ
âââââââââââââ§ââââââââââââââââââ§ââââââââââââââââââââââââââââââââââââââââââ</pre>
</div>
</div>
<div class="paragraph">
<p>I started another shell (leaving the current shell opened) and then I typed the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf apps
Getting apps in org pcfdev-org / space pcfdev-space as admin...
OK

name                            requested state   instances   memory   disk   urls
dataflow-server                 started           1/1         2G       2G     dataflow-server.local.pcfdev.io
dataflow-server-httptest-log    started           1/1         512M     512M   dataflow-server-httptest-log.local.pcfdev.io
dataflow-server-httptest-http   started           1/1         512M     512M   dataflow-server-httptest-http.local.pcfdev.io</pre>
</div>
</div>
<div class="paragraph">
<p>In order to view the log output for <code>dataflow-server-httptest-log</code>, I typed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf logs dataflow-server-httptest-log
Retrieving logs for app dataflow-httptest-log in org pcfdev-org / space pcfdev-space as admin...</pre>
</div>
</div>
<div class="paragraph">
<p>Back to the first shell (running <code>spring-cloud-dataflow-shell</code>), I typed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dataflow:&gt;http post --target http://dataflow-server-httptest-http.local.pcfdev.io --data "hello world"
&gt; POST (text/plain;Charset=UTF-8) http://dataflow-httptest-http.local.pcfdev.io hello world
&gt; 202 ACCEPTED

dataflow:&gt;http post --target http://dataflow-server-httptest-http.local.pcfdev.io --data "paulo jeronimo"
&gt; POST (text/plain) http://dataflow-server-httptest-http.local.pcfdev.io paulo jeronimo
&gt; 202 ACCEPTED</pre>
</div>
</div>
<div class="paragraph">
<p>So, this lines appears in the output of the command <code>cf logs dataflow-server-httptest-log</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   2018-04-29T14:15:04.21+0100 [APP/PROC/WEB/0] OUT 2018-04-29 13:15:04.215  INFO 6 --- [http.httptest-1] log.sink                                 : hello world
   2018-04-29T14:17:22.83+0100 [APP/PROC/WEB/0] OUT 2018-04-29 13:17:22.832  INFO 6 --- [http.httptest-1] log.sink                                 : paulo jeronimo</pre>
</div>
</div>
<div class="paragraph">
<p>My last command was delete the created stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dataflow:&gt;stream destroy --name httptest
Destroyed stream 'httptest'
dataflow:&gt;exit</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_10_stop_pcf_dev">Step 10 - Stop PCF Dev</h3>
<div class="listingblock">
<div class="content">
<pre>cf dev stop</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_11_optional_destroy_the_pcf_dev_environment">Step 11 - (Optional) Destroy the PCF Dev environment</h3>
<div class="listingblock">
<div class="content">
<pre>cf dev destroy</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lab2-conclusions">Conclusions</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Positive points: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The PCF Dev also makes the deployment of SCDF components very simple.
The <code>cf</code> command makes easy, in a development environment, to push new sources, sinks, or processors to the servers.</p>
</li>
<li>
<p>The shell interface provided by <a href="#spring-cloud-dataflow-shell">[spring-cloud-dataflow-shell]</a> is extremely useful to automate things.
This kind of tool is totally required in a DevOps world.</p>
</li>
<li>
<p>Based on this lab, I can deduce that in a large corporation with <a href="https://run.pivotal.io/">Pivotal Cloud Foundry</a> installed on its servers, SCDF is definitely prepared and integrated with this kind of infrastructure.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Negative points: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The time to start PCF Dev on my machine was very slow compared to the time to up Docker containers with Docker compose.
So, I would recommend the use of Docker in a developer environment instead of PCF Dev.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_references_2">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#oA">"Getting Started with Spring Cloud Data Flow on PCF Dev"</a> (oA)</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-cloud-dataflow-samples/docs/current/reference/htmlsingle">Spring Cloud Data Flow Samples Documentation</a></p>
</li>
<li>
<p><a href="https://pivotal.io/platform/pcf-tutorials/getting-started-with-pivotal-cloud-foundry-dev/install-pcf-dev">Install PCF Dev CLI</a>.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lab3">Lab 3: Creating a custom processor application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By doing this lab I wanted to discover the effort related to a creation of a new processor in a development environment.
So, if a new processor was easy to create, I could assume that sources and sinks also could be.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites_3">Prerequisites</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#lab1">Lab 1</a> executed.</p>
</li>
<li>
<p><a href="http://sdkman.io/">SDKMAN</a> installed.</p>
</li>
<li>
<p><a href="https://maven.apache.org">Maven</a> installed (in my case, this was done via <a href="http://sdkman.io/">SDKMAN</a>).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="lab3-step1">Step 1 - Create a rabbitmq Docker container</h3>
<div class="paragraph">
<p>I looked for and created a rabbitmq container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ docker search rabbitmq
$ docker run -d -p 5672:5672 -p 15672:15672  --name rabbitmq rabbitmq</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_download_and_start_manually_sources_and_sinks">Step 2 - Download and start, manually, sources and sinks</h3>
<div class="paragraph">
<p>I changed my work directory to the directory created on "Lab 1":</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/labs/spring-cloud-dataflow</pre>
</div>
</div>
<div class="paragraph">
<p>I downloaded some pre-existing sources and sinks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ wget -c https://repo.spring.io/libs-release/org/springframework/cloud/stream/app/http-source-rabbit/1.3.1.RELEASE//http-source-rabbit-1.3.1.RELEASE.jar
$ wget -c https://repo.spring.io/release/org/springframework/cloud/stream/app/log-sink-rabbit/1.3.1.RELEASE/log-sink-rabbit-1.3.1.RELEASE.jar</pre>
</div>
</div>
<div class="paragraph">
<p>I started them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 2
$ java -Dserver.port=8123 \
-Dhttp.path-pattern=/data \
-Dspring.cloud.stream.bindings.output.destination=sensorData \
-jar http-source-rabbit-1.3.1.RELEASE.jar

# shell 3
$ java -Dlog.level=WARN \
-Dspring.cloud.stream.bindings.input.destination=sensorData \
-jar log-sink-rabbit-1.3.1.RELEASE.jar</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note the use of the the parameters passed to source and sync.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>I sent a post via curl:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 1
$ curl -H "Content-Type: application/json" -X POST -d '{"id":"1","temperature":"100"}' http://localhost:8123/data</pre>
</div>
</div>
<div class="paragraph">
<p>I noticed the log that apperars on <code>shell 3</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2018-05-01 20:23:16.955  WARN 23145 --- [Li0KHY-B-ej_w-1] log-sink                                 : {"id":"1","temperature":"100"}</pre>
</div>
</div>
<div class="paragraph">
<p>I stopped all running micro services (on shells 2 and 3) and, also, the rabbitmq container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ docker stop rabbitmq</pre>
</div>
</div>
<div class="paragraph">
<p>I closed all the other shells (2 and 3) and went back to shell 1.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_create_and_run_a_new_processor_manually">Step 3 - Create and run a new processor manually</h3>
<div class="paragraph">
<p>To use <a href="https://start.spring.io/">Spring Initializr</a> via command line, I <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/cli-installation.html">installed Spring Boot CLI</a> via <a href="http://sdkman.io/">SDKMAN</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sdk install springboot</pre>
</div>
</div>
<div class="paragraph">
<p>I generated the initial <code>transformer</code> code using <code>spring init</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir transformer &amp;&amp; cd $_
$ spring init -d=cloud-stream -g=io.spring.stream.sample -a=transformer -n=transformer --package-name=io.spring.stream.sample ../transformer.zip
$ unzip ../transformer.zip</pre>
</div>
</div>
<div class="paragraph">
<p>I saw the created directory structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ tree
.
|-- mvnw
|-- mvnw.cmd
|-- pom.xml
`-- src
    |-- main
    |   |-- java
    |   |   `-- io
    |   |       `-- spring
    |   |           `-- stream
    |   |               `-- sample
    |   |                   `-- TransformerApplication.java
    |   `-- resources
    |       `-- application.properties
    `-- test
        `-- java
            `-- io
                `-- spring
                    `-- stream
                        `-- sample
                            `-- TransformerApplicationTests.java

14 directories, 6 files</pre>
</div>
</div>
<div class="paragraph">
<p>I added the code <code>Transformer.java</code> to the <code>transformer</code> project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cp ../tutorial/files/Transformer.java src/main/java/io/spring/stream/sample/</pre>
</div>
</div>
<div class="paragraph">
<p>This is the code that was added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package io.spring.stream.sample;

import org.springframework.cloud.stream.annotation.EnableBinding;
import org.springframework.cloud.stream.annotation.Output;
import org.springframework.cloud.stream.annotation.StreamListener;
import org.springframework.cloud.stream.messaging.Processor;

import java.util.HashMap;
import java.util.Map;

@EnableBinding(Processor.class)
public class Transformer {

    @StreamListener(Processor.INPUT)
    @Output(Processor.OUTPUT)
    public Map&lt;String, Object&gt; transform(Map&lt;String, Object&gt; doc) {
        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();
        map.put("sensor_id", doc.getOrDefault("id", "-1"));
        map.put("temp_val", doc.getOrDefault("temperature", "-999"));
        return map;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>I patched the <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ patch pom.xml &lt; ../tutorial/files/pom.xml.patch
patching file pom.xml</pre>
</div>
</div>
<div class="paragraph">
<p>This is the patch that was applied:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-diff" data-lang="diff">--- pom.xml.original	2018-04-30 23:07:31.000000000 +0100
+++ pom.xml	2018-04-30 23:07:38.000000000 +0100
@@ -28,10 +28,14 @@
 	&lt;dependencies&gt;
 		&lt;dependency&gt;
 			&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
-			&lt;artifactId&gt;spring-cloud-stream&lt;/artifactId&gt;
+			&lt;artifactId&gt;spring-cloud-starter-stream-rabbit&lt;/artifactId&gt;
 		&lt;/dependency&gt;

 		&lt;dependency&gt;
+			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
+			&lt;artifactId&gt;spring-web&lt;/artifactId&gt;
+		&lt;/dependency&gt;
+		&lt;dependency&gt;
 			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
 			&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
 			&lt;scope&gt;test&lt;/scope&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>I changed the code of <code>TransformerApplicationTests.java</code> by applying another patch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ patch src/test/java/io/spring/stream/sample/TransformerApplicationTests.java &lt; ../tutorial/files/TransformerApplicationTests.java.patch
patching file src/test/java/io/spring/stream/sample/TransformerApplicationTests.java</pre>
</div>
</div>
<div class="paragraph">
<p>This is the source code of the applied patch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-diff" data-lang="diff">--- TransformerApplicationTests.java.original	2018-04-30 21:40:01.000000000 +0100
+++ TransformerApplicationTests.java	2018-04-30 21:40:35.000000000 +0100
@@ -2,15 +2,35 @@

 import org.junit.Test;
 import org.junit.runner.RunWith;
+import org.springframework.beans.factory.annotation.Autowired;
 import org.springframework.boot.test.context.SpringBootTest;
 import org.springframework.test.context.junit4.SpringRunner;

+import java.util.HashMap;
+import java.util.Map;
+
+import static org.assertj.core.api.Assertions.assertThat;
+import static org.assertj.core.api.Assertions.entry;
+
 @RunWith(SpringRunner.class)
-@SpringBootTest
+@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
 public class TransformerApplicationTests {

-	@Test
-	public void contextLoads() {
-	}
+    @Autowired
+    private Transformer transformer;
+
+    @Test
+    public void simpleTest() {
+        Map&lt;String, Object&gt; resultMap = transformer.transform(createInputData());
+        assertThat(resultMap).hasSize(2)
+                .contains(entry("sensor_id", "1"))
+                .contains(entry("temp_val", "100"));
+    }

+    private Map&lt;String, Object&gt; createInputData() {
+        HashMap&lt;String, Object&gt; inputData = new HashMap&lt;&gt;();
+        inputData.put("id", "1");
+        inputData.put("temperature", "100");
+        return inputData;
+    }
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, I built the package using Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./mvnw clean package
$ cp target/transformer-0.0.1-SNAPSHOT.jar ..
$ cd ..</pre>
</div>
</div>
<div class="paragraph">
<p>I started rabbitmq (it it was stopped before):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ docker start rabbitmq</pre>
</div>
</div>
<div class="paragraph">
<p>I started the services:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 2
$ java  -Dserver.port=8123 \
        -Dhttp.path-pattern=/data \
        -Dspring.cloud.stream.bindings.output.destination=sensorData \
        -jar http-source-rabbit-1.3.1.RELEASE.jar

# shell 3
$ java  -Dserver.port=8090 \
        -Dspring.cloud.stream.bindings.input.destination=sensorData \
        -Dspring.cloud.stream.bindings.output.destination=normalizedSensorData \
        -jar transformer-0.0.1-SNAPSHOT.jar

# shell 4
$ java  -Dlog.level=WARN \
        -Dspring.cloud.stream.bindings.input.destination=normalizedSensorData \
        -jar log-sink-rabbit-1.3.1.RELEASE.jar</pre>
</div>
</div>
<div class="paragraph">
<p>I tested the services using curl:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 1
$ curl -H "Content-Type: application/json" -X POST -d '{"id":"1","temperature":"100"}' http://localhost:8123/data</pre>
</div>
</div>
<div class="paragraph">
<p>I noticed the following output on <code>shell 4</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2018-05-01 20:33:30.715  WARN 23584 --- [k2tWV9V6IhDPg-1] log-sink                                 : {"sensor_id":"24e8778c-c275-237b-5e0a-f9f96eea8d62","temp_val":"-999"}</pre>
</div>
</div>
<div class="paragraph">
<p>I stopped all micro services and left the rabbitmq container running to execute my next steps.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_run_the_new_processor_using_spring_cloud_dataflow_server_local">Step 4 - Run the new processor using spring-cloud-dataflow-server-local</h3>
<div class="paragraph">
<p>I downloaded the local spring-cloud-dataflow server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ wget -c https://repo.spring.io/release/org/springframework/cloud/spring-cloud-dataflow-server-local/1.4.0.RELEASE/spring-cloud-dataflow-server-local-1.4.0.RELEASE.jar</pre>
</div>
</div>
<div class="paragraph">
<p>I started it on current shell (1):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar spring-cloud-dataflow-server-local-1.4.0.RELEASE.jar</pre>
</div>
</div>
<div class="paragraph">
<p>Using the spring-cloud-dataflow shell, I manually register the components and created the stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 2
$ java -jar spring-cloud-dataflow-shell-1.4.0.RELEASE.jar
dataflow:&gt;app list
No registered apps.
You can register new apps with the 'app register' and 'app import' commands.

app register --type source --name http --uri file:///Users/pj/labs/spring-cloud-dataflow/http-source-rabbit-1.3.1.RELEASE.jardataflow:&gt;app register --type source --name http --uri file:///Users/pj/labs/spring-cloud-dataflow/http-source-rabbit-1.3.1.RELEASE.jar
Successfully registered application 'source:http'

dataflow:&gt;app register --type sink --name log --uri file:///Users/pj/labs/spring-cloud-dataflow/log-sink-rabbit-1.3.1.RELEASE.jar
Successfully registered application 'sink:log'

dataflow:&gt;app register --type processor --name transformer --uri file:///Users/pj/labs/spring-cloud-dataflow/transformer-0.0.1-SNAPSHOT.jar
Successfully registered application 'processor:transformer'

dataflow:&gt;stream create --name httpIngest --definition "http --server.port=8123 --path-pattern=/data | transformer --server.port=8090 | log --level=WARN" --deploy
Created new stream 'httpIngest'
Deployment request has been sent</pre>
</div>
</div>
<div class="paragraph">
<p>When the stream was created, I saw in the server log:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 1
2018-05-01 01:47:48.121  INFO 15385 --- [nio-9393-exec-2] o.s.c.d.spi.local.LocalAppDeployer       : Deploying app with deploymentId httpIngest.log instance 0.
   Logs will be in /var/folders/tx/xxk5qr1j5txfm5yvs3p9k9bc0000gn/T/spring-cloud-deployer-4223749192815736035/httpIngest-1525135668085/httpIngest.log</pre>
</div>
</div>
<div class="paragraph">
<p>I checked if the stream was deployed and exited the <code>spring-cloud-dataflow-shell</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 2
dataflow:&gt;stream list
...
dataflow:&gt;exit</pre>
</div>
</div>
<div class="paragraph">
<p>I started <code>tail</code> to monitoring the <code>stdout_0.log</code> file in background:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ tail -f /var/folders/tx/xxk5qr1j5txfm5yvs3p9k9bc0000gn/T/spring-cloud-deployer-4223749192815736035/httpIngest-1525135668085/httpIngest.log/stdout_0.log &amp;</pre>
</div>
</div>
<div class="paragraph">
<p>I sent a POST to source via <code>curl</code> and saw an output presented by then running instance of <code>tail</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -H "Content-Type: application/json" -X POST -d '{"id":"1","temperature":"100"}' http://localhost:8123/data
2018-05-01 01:52:34.997  WARN 15445 --- [er.httpIngest-1] log-sink                                 : {"sensor_id":"43738bcb-2af5-917e-61ff-4c2837c5de83","temp_val":"-999"}</pre>
</div>
</div>
<div class="paragraph">
<p>I stopped the spring-cloud-dataflow server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shell 1
&lt;Ctrl+C&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>I killed the <code>tail</code> process on <code>shell 2</code> and closed it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ pkill tail
$ exit</pre>
</div>
</div>
<div class="paragraph">
<p>I went back to <code>shell 1</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_stop_and_destroy_rabbitmq_container">Step 5 - Stop and destroy rabbitmq container</h3>
<div class="listingblock">
<div class="content">
<pre>$ docker stop rabbitmq
$ docker ps -a | grep 'Exited.*rabbitmq$' | cut -d ' ' -f 1 | xargs docker rm</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lab3-conclusions">Conclusions</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Positive points: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Create a project is very quick and simple.
<a href="https://start.spring.io/">Spring Initializr</a> provides these features.</p>
</li>
<li>
<p>Create a new processor is also very easy, like to do any other Spring Boot application.</p>
<div class="ulist">
<ul>
<li>
<p>Any team with a development background on creating Spring Boot applications has the necessary knowledge.
Only a few new annotations/APIs must be studied to getting started.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The use of Docker in development environment make things extremally easier.</p>
</li>
<li>
<p>The source code for sources (like <code>http</code>) and sinks (like <code>log</code>) are quite simple and available on GitHub (see the references below).
So you can see them to guide yourself in the development of your own components.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Negative points: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The Spring documentation, one more time, needs to be more accurate to help the developers better.</p>
<div class="ulist">
<ul>
<li>
<p>Some bugs I have to solve myself:</p>
<div class="ulist">
<ul>
<li>
<p>The generated code for <code>transformer</code> came with an incorrect <code>pom.xml</code>, so I had to patch it.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Some points were omitted or could be better explained in the Spring documentation:</p>
<div class="ulist">
<ul>
<li>
<p>How to quickly install and use RabbitMQ in a development environment in order to test Spring Cloud Data Flow?
I found a solution to this question <a href="https://coderwall.com/p/uqp34w/install-rabbitmq-via-docker-in-os-x">in this post</a>.</p>
</li>
<li>
<p>I needed to modify the generated <code>pom.xml</code> in order to make the <code>Transformer</code> test run successfully.
For this, I had to search the Internet until I found <a href="https://stackoverflow.com/a/42237483">a solution on Stack Overflow</a> for my problem.
In my point of view, Spring Initializr failed to generate the correct <code>pom.xml</code> or I passed wrong arguments to it.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_references_3">References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/#streams-dev-guide">Stream Developer Guide</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/cli-installation.html">Installing the CLI</a></p>
</li>
<li>
<p><a href="http://cloud.spring.io/spring-cloud-stream-app-starters/">Spring Cloud Stream App Starters</a></p>
</li>
<li>
<p><a href="https://github.com/spring-cloud-stream-app-starters/http/tree/master/spring-cloud-starter-stream-source-http">Http Source</a> (GitHub)</p>
</li>
<li>
<p><a href="https://github.com/spring-cloud-stream-app-starters/log">Log Sink</a> (GitHub)</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lab4">Lab 4: Setting up a Windows environment to develop with SCDF</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this lab, my intention was to discover if I can easily setup a <strong>Windows 10</strong> development environment
(using a non-administrative account (<code>user1</code>)) to run SCDF manually (without <a href="https://www.docker.com/">Docker</a> or <a href="https://pivotal.io/pcf-dev">PCF Dev</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A Window admin account is required in many corporations that obligates their employees to use such environment.
So, in this lab, I tried to install the maximum possible quantity of software that would not require me admin rights.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>I didn&#8217;t touch any Java code and in this lab (and in the next three as well).
That was because I was only reviewing (or fixing or maybe growing) some concepts that I already presented in previous labs.
But anyway, by creating theses labs I reviewed the fundamentals of both technologies from a perspective of a Windows developer.</p>
</div>
<div class="paragraph">
<p>So, to do the next labs I needed:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A Windows 10 environment.</p>
</li>
<li>
<p>A Bash shell installed on it (<a href="https://superuser.com/questions/1053633/what-is-git-bash-for-windows-anyway">Git Bash</a>).</p>
</li>
<li>
<p>A Java Development Kit (JDK) (&gt;= 1.8).</p>
</li>
<li>
<p>A <a href="https://www.rabbitmq.com/">RabbitMQ</a> instance started (it will be used in this state during the next windows labs).</p>
</li>
<li>
<p>A clone (or zip) of the repository that contains this tutorial.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_prerequisites_4">Prerequisites</h3>
<div class="paragraph">
<p>A Windows 10 environment.
I started one from a VMware snapshot.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_creating_of_user1">Step 1 - Creating of user1</h3>
<div class="paragraph">
<p>I followed the Windows steps to create a new user called <code>user1</code> with no admin rights.
After that, I used this account to do the next steps.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_gitbash_installation">Step 2 - GitBash installation</h3>
<div class="paragraph">
<p>I downloaded and extracted <a href="https://git-scm.com/download/win">Git for Windows Portable</a> on <code>C:\Portable\Git</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_java_development_kit_installation">Step 3 - Java Development Kit installation</h3>
<div class="paragraph">
<p>I downloaded and extracted <a href="https://portableapps.com/apps/utilities/jdkportable">jdkPortable</a> on <code>C:\Portable\JDK</code>.</p>
</div>
<div class="paragraph">
<p>I have setup up the variables <code>JAVA_HOME</code> and <code>PATH</code> (appending <code>%JAVA_HOME%\bin</code> to it).</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_rabbitmq_installation">Step 4 - RabbitMQ installation</h3>
<div class="paragraph">
<p>A simple alternative to starting RabbitMQ without needing an administrator account would be download and executing <a href="https://github.com/isindicic/RabbitMqPortable">RabbitMQ portable</a>.
I tried to do this.
But this didn&#8217;t work in Windows 10 like worked for Windows 7.</p>
</div>
<div class="paragraph">
<p>In Windows 10 the most rapidly form to leave problems behind was by following the <a href="https://www.rabbitmq.com/install-windows.html">installation steps for RabbitMQ</a>.
This required admin rights. But, to move on without wasting time on other alternatives, this was the simplest solution.
When all installation procedures was done, I checked if the RabbitMQ service was running by searching it on windows <code>services</code>.</p>
</div>
<div class="paragraph">
<p>Finally, If I could use <a href="https://www.docker.com/">Docker</a> on Windows, obviously I would use a RabbitMQ container <a href="#lab3-step1">like I did in lab 3</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_download_this_repository">Step 5 - Download this repository</h3>
<div class="paragraph">
<p>I just typed the following commands by openning the Git Bash shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd /c
$ git clone https://github.com/paulojeronimo/spring-cloud-dataflow-tutorial scdf-tutorial</pre>
</div>
</div>
<div class="paragraph">
<p>This created the repository&#8217;s clone for me (on <code>C:\scdf-tutorial</code>).</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lab5">Lab 5: Connecting a source to a sink using Spring Cloud Stream</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prerequisites_5">Prerequisites</h3>
<div class="paragraph">
<p><a href="#lab4">Lab 4</a> executed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_download_some_spring_cloud_stream_apps">Step 1 - Download some Spring Cloud Stream Apps</h3>
<div class="paragraph">
<p>To start this lab my first step was to associate all files with <code>.sh</code> extension with <code>git-bash.exe</code>.</p>
</div>
<div class="paragraph">
<p>After that, I clicked on <code>C:\scdf-tutorial\files\get-lab5-jars.sh</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>get-lab5-jars.sh</code> is a script that I created to download two jars for me with the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">curl -L -O -C - http://central.maven.org/maven2/org/springframework/cloud/stream/app/http-source-rabbit/1.3.1.RELEASE/http-source-rabbit-1.3.1.RELEASE.jar

curl -L -O -C - http://central.maven.org/maven2/org/springframework/cloud/stream/app/log-sink-rabbit/1.3.1.RELEASE/log-sink-rabbit-1.3.1.RELEASE.jar</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After the download finishes I noticed that the presence of two files (jars) on <code>C:\scdf-tutorial\files</code>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>http-source-rabbit-1.3.1.RELEASE.jar</code></p>
</li>
<li>
<p><code>log-sink-rabbit-1.3.1.RELEASE.jar</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_start_http_source_rabbit">Step 2 - Start http-source-rabbit</h3>
<div class="paragraph">
<p>To open a window that runs the following Java command, I clicked <code>http-source-rabbit.bat</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -Dserver.port=8123 -Dhttp.path-pattern=/data -Dspring.cloud.stream.bindings.output.destination=sensorData -jar http-source-rabbit-1.3.1.RELEASE.jar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_start_log_sink_rabbit">Step 3 - Start log-sink-rabbit</h3>
<div class="paragraph">
<p>I also clicked <code>log-sink-rabbit.bat</code>.
This script opened another window running the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -Dlog.level=WARN -Dspring.cloud.stream.bindings.input.destination=sensorData -jar log-sink-rabbit-1.3.1.RELEASE.jar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_send_a_post_request_and_get_a_result">Step 4 - Send a POST request and get a result</h3>
<div class="paragraph">
<p>I opened the Git Bash shell and typed the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -s -H "Content-Type: application/json" -X POST -d '{"id":"1","temperature":"100"}' http://localhost:8123/data</pre>
</div>
</div>
<div class="paragraph">
<p>I noticed some log output on <code>http-source-rabbit</code> window and, after that, this output on <code>log-sink-rabbit</code> window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2018-05-... WARN 4222 --- [tp.httpIngest-1] log-sink                                 : {"id":"1","temperature":"100"}</pre>
</div>
</div>
<div class="paragraph">
<p>I finished the <code>log-sink-rabbit</code> execution by pressing <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>C</kbd></span> on its window.
Also, to terminate this lab, I did the same in <code>http-source-rabbit</code> window.</p>
</div>
</div>
<div class="sect2">
<h3 id="_notes_conclusions">Notes/conclusions</h3>
<div class="paragraph">
<p>In this lab, I basically review things that were done behind the scenes from the previous labs.
Two microservices where executed independently talking to each other through a message broker (RabbitMQ).
The "channel" used in this conversation (<code>sensorData</code>) was passed to the following properties:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a id="http-source-property"></a> On source (<code>http-source</code>): <code>spring.cloud.stream.bindings.output.destination</code>.</p>
</li>
<li>
<p><a id="log-sink-property"></a> On sink (<code>log-sink</code>): <code>spring.cloud.stream.bindings.input.destination</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The name of the "channel" could be anything I want.
But it needs to be the same for both properties.</p>
</div>
<div class="paragraph">
<p>The <code>http-source</code> is a kind of microservice that produces an output.
This output is produced when the source receives a POST request in the path <code>/data</code>.
The default implementation os this microservice only pass along the received data to the message broker.
So the destination of its output is specified by <a href="#http-source-property">this property</a>.</p>
</div>
<div class="paragraph">
<p>The <code>log-sink</code> is a kind of microservice that consumes an input.
In this case, when some input is available on the message broker, it will be consumed (removed from the "channel") and presented in the log output of the microservice.
So, I must specify to the <code>log-sink</code> where the input will be available by configuring <a href="#log-sink-property">this property</a>.</p>
</div>
<div class="paragraph">
<p>Both <code>http-source</code> and <code>log-sink</code> were Spring Boot applications.
<a href="https://content.pivotal.io/slides/scaling-spring-boot-applications-in-real-time">Spring Boot applications can be scaled up in Real-Time</a> in many ways.
So, <code>http-source</code> and <code>log-sink</code> can be easily scaled up and, also, independently!</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lab6">Lab 6: Manually using SCDF (server local/shell)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prerequisites_6">Prerequisites</h3>
<div class="paragraph">
<p><a href="#lab5">Lab 5</a> executed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_download_spring_cloud_data_flow_jars_server_local_and_shell">Step 1 - Download Spring Cloud Data Flow jars (server-local and shell)</h3>
<div class="paragraph">
<p>I clicked on <code>C:\scdf-tutorial\files\get-lab6-jars.sh</code>.
This script only executes the following commands to download the two jars needed by this lab:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -L -O -C - http://central.maven.org/maven2/org/springframework/cloud/spring-cloud-dataflow-server-local/1.4.0.RELEASE/spring-cloud-dataflow-server-local-1.4.0.RELEASE.jar

curl -L -O -C - http://central.maven.org/maven2/org/springframework/cloud/spring-cloud-dataflow-shell/1.4.0.RELEASE/spring-cloud-dataflow-shell-1.4.0.RELEASE.jar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_start_spring_cloud_data_flow_server_local_and_shell">Step 2 - Start Spring Cloud Data Flow (server-local and shell)</h3>
<div class="paragraph">
<p>I clicked <code>spring-cloud-dataflow-server-local.bat</code> to start SCDF local with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar spring-cloud-dataflow-server-local-1.4.0.RELEASE.jar</pre>
</div>
</div>
<div class="paragraph">
<p>After that, I also clicked on <code>spring-cloud-dataflow-shell.bat</code>.
This script started SCDF shell through the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar spring-cloud-dataflow-shell-1.4.0.RELEASE.jar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_register_applications_create_and_deploy_a_stream">Step 3 - Register applications, create and deploy a stream</h3>
<div class="paragraph">
<p>I typed the following commands on shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>app register --type source --name http --uri file://C:/scdf-tutorial/files/http-source-rabbit-1.3.1.RELEASE.jar
app register --type sink --name log --uri file://C:/scdf-tutorial/files/log-sink-rabbit-1.3.1.RELEASE.jar
stream create --name httpIngest --definition "http --server.port=8123 --path-pattern=/data | log --level=WARN"
stream deploy --name httpIngest
stream list</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_monitor_the_stream_log">Step 4 - Monitor the stream log</h3>
<div class="paragraph">
<p>I noticed the following log output on <code>spring-cloud-dataflow-server-local</code> window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2018-05... INFO 7432 --- [nio-9393-exec-5] o.s.c.d.spi.local.LocalAppDeployer       : Command to be executed: C:\Portable\JDK\jre\bin\java.exe -jar C:\scdf-tutorial\files\log-sink-rabbit-1.3.1.RELEASE.jar
2018-05... INFO 7432 --- [nio-9393-exec-5] o.s.c.d.spi.local.LocalAppDeployer       : Deploying app with deploymentId httpIngest.log instance 0.
   Logs will be in C:\Users\user1\AppData\Local\Temp\spring-cloud-deployer-7284336212701312273\httpIngest-1526842618079\httpIngest.log</pre>
</div>
</div>
<div class="paragraph">
<p>So, I opened Git Bash to run the <code>tail</code> command in background and monitor the log output with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>tail -f "C:\Users\user1\AppData\Local\Temp\spring-cloud-deployer-7284336212701312273\httpIngest-1526842618079\httpIngest.log\stdout_0.log" &amp;</pre>
</div>
</div>
<div class="paragraph">
<p>I repeat the <code>curl</code> command that I did last lab:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -s -H "Content-Type: application/json" -X POST -d '{"id":"1","temperature":"100"}' http://localhost:8123/data</pre>
</div>
</div>
<div class="paragraph">
<p>I noticed an output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2018-05-... WARN 4222 --- [tp.httpIngest-1] log-sink                                 : {"id":"1","temperature":"100"}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_accessing_the_graphical_ui_dashboard">Step 5 - Accessing the Graphical UI Dashboard</h3>
<div class="paragraph">
<p>After many steps did by using a command line, I wanted to see some graphical user interface.
I pointed my brower to the dashboard: <a href="http://localhost:9393/dashboard" class="bare">http://localhost:9393/dashboard</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Microsoft Edge browser had some CSS problems when I opened the dashboard with it. So, I switched to Firefox.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By opening the dashboard I saw the tab <code>Apps</code> where I all the apps were registered.
This tab provides the ability to register or unregister applications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/01.png" alt="01">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_inspecting_the_tabs">Step 6 - Inspecting the tabs</h3>
<div class="paragraph">
<p>By clicking on a application (like <code>http</code>) I could see its properties:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/02.png" alt="02">
</div>
</div>
<div class="paragraph">
<p>The <code>Runtime</code> tab shows the list of all running apps:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/03.png" alt="03">
</div>
</div>
<div class="paragraph">
<p>By clicking on the app <code>httpIngest.log</code> I also saw the <code>stdout</code> path.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/04.png" alt="04">
</div>
</div>
<div class="paragraph">
<p>The <code>Streams</code> tab list all the stream definitions and provides the ability to deploy/deploy or destroy streams:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/05.png" alt="05">
</div>
</div>
<div class="paragraph">
<p>I could expand the stream definition:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/06.png" alt="06">
</div>
</div>
<div class="paragraph">
<p>The <code>Tasks</code> tab will be discussed on a next lab.</p>
</div>
<div class="paragraph">
<p>The <code>Jobs</code> tab will be discussed on a next lab.</p>
</div>
<div class="paragraph">
<p>The most left tab (<code>About</code>) is where I could get information about SCDF:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/08.png" alt="08">
</div>
</div>
<div class="paragraph">
<p>I destroyed the created stream (<code>httpIngest</code>) using the UI:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/09.png" alt="09">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_backing_to_the_shell">Step 7 - Backing to the shell</h3>
<div class="paragraph">
<p>I checked if the stream was really destroyed by using the shell with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>stream list</pre>
</div>
</div>
<div class="paragraph">
<p>I typed the followed commands to unregister the applications:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>app list
app unregister --type source --name http
app unregister --type sink --name log</pre>
</div>
</div>
<div class="paragraph">
<p>Backing to the UI, I could check that I had no registered apps anymore:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lab6/10.png" alt="10">
</div>
</div>
<div class="paragraph">
<p>I left the windows that I opened (<code>spring-cloud-dataflow-server-local.bat</code> and <code>spring-cloud-dataflow-shell.bat</code>) running in order to continue the next lab.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lab7">Lab 7: Importing existing sources, sinks, processors and tasks to SCDF</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prerequisites_7">Prerequisites</h3>
<div class="paragraph">
<p>Windows <code>spring-cloud-dataflow-server-local</code> and <code>spring-cloud-dataflow-shell</code> started and in the last status of the previous lab.</p>
</div>
</div>
<div class="sect2">
<h3 id="_steps">Steps</h3>
<div class="paragraph">
<p>Inside <code>spring-cloud-dataflow-shell.bat</code> window, I typed the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>app import --uri http://bit.ly/Celsius-SR1-stream-applications-rabbit-maven</pre>
</div>
</div>
<div class="paragraph">
<p>The output of this command was the showed bellow.
I saw that a lot of applications (65) were registered:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Successfully registered 65 applications from [source.sftp, source.mqtt.metadata, sink.mqtt.metadata, source.file.metadata, processor.tcp-client, source.s3.metadata, source.jms, source.ftp, processor.transform.metadata, source.time, sink.mqtt, sink.s3.metadata, processor.scriptable-transform, sink.log, source.load-generator, processor.transform, source.syslog, sink.websocket.metadata, sink.task-launcher-local.metadata, source.loggregator.metadata, source.s3, source.load-generator.metadata, processor.pmml.metadata, source.loggregator, source.tcp.metadata, processor.httpclient.metadata, sink.file.metadata, source.triggertask, source.twitterstream, source.gemfire-cq.metadata, processor.aggregator.metadata, source.mongodb, source.time.metadata, source.gemfire-cq, sink.counter.metadata, source.http, sink.tcp.metadata, sink.pgcopy.metadata, source.rabbit, sink.task-launcher-yarn, source.jms.metadata, sink.gemfire.metadata, sink.cassandra.metadata, processor.tcp-client.metadata, processor.header-enricher, sink.throughput, sink.task-launcher-local, processor.python-http, sink.aggregate-counter.metadata, sink.mongodb, processor.twitter-sentiment, sink.log.metadata, processor.splitter, sink.hdfs-dataset, source.tcp, processor.python-jython.metadata, source.trigger, source.mongodb.metadata, processor.bridge, source.http.metadata, source.rabbit.metadata, sink.ftp, sink.jdbc, source.jdbc.metadata, source.mqtt, processor.pmml, sink.aggregate-counter, sink.rabbit.metadata, processor.python-jython, sink.router.metadata, sink.cassandra, processor.filter.metadata, source.tcp-client.metadata, processor.header-enricher.metadata, processor.groovy-transform, source.ftp.metadata, sink.router, sink.redis-pubsub, source.tcp-client, processor.httpclient, sink.file, sink.websocket, source.syslog.metadata, sink.s3, sink.counter, sink.rabbit, processor.filter, source.trigger.metadata, source.mail.metadata, sink.gpfdist.metadata, sink.pgcopy, processor.python-http.metadata, sink.jdbc.metadata, sink.gpfdist, sink.ftp.metadata, processor.splitter.metadata, sink.sftp, sink.field-value-counter, processor.groovy-filter.metadata, processor.twitter-sentiment.metadata, source.triggertask.metadata, sink.hdfs, processor.groovy-filter, sink.redis-pubsub.metadata, source.sftp.metadata, processor.bridge.metadata, sink.field-value-counter.metadata, processor.groovy-transform.metadata, processor.aggregator, sink.sftp.metadata, processor.tensorflow.metadata, sink.throughput.metadata, sink.hdfs-dataset.metadata, sink.tcp, source.mail, sink.task-launcher-cloudfoundry.metadata, source.gemfire.metadata, processor.tensorflow, source.jdbc, sink.task-launcher-yarn.metadata, sink.gemfire, source.gemfire, source.twitterstream.metadata, sink.hdfs.metadata, processor.tasklaunchrequest-transform, sink.task-launcher-cloudfoundry, source.file, sink.mongodb.metadata, processor.tasklaunchrequest-transform.metadata, processor.scriptable-transform.metadata]</pre>
</div>
</div>
<div class="paragraph">
<p>All these aplications could also be viewed in the dashboard (<a href="http://localhost:9393/dashboard" class="bare">http://localhost:9393/dashboard</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_notes_conclusions_2">Notes/conclusions</h3>
<div class="paragraph">
<p>After the registration, the applications were stored in my local maven repository (the <code>~/.m2</code> directory).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>I could check this information by typing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ find ~/.m2/repository/org/springframework/cloud/stream -type f -name '*.jar' | wc -l
      65</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>I could customize the applications that I want to install by creating a properties file.</p>
</div>
<div class="paragraph">
<p>For example, I could type the following commands to save and edit a <code>apps.properties</code> file only with the contents I would like to have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -L http://bit.ly/Celsius-SR1-stream-applications-rabbit-maven &gt; apps.properties
vim apps.properties</pre>
</div>
</div>
<div class="paragraph">
<p>By doing this I could specify which sources, sinks, processors, and tasks, that I want to deploy.</p>
</div>
<div class="paragraph">
<p>I could also customize the maven repository used to download these applications.
To do this I only need to specify a property like in following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar spring-cloud-dataflow-server-local-1.4.0.RELEASE.jar --maven.remote-repositories.repo1.url=http://nexus.example.com/repository/maven-central/</pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_all_references">All references</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">Spring</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">GitHub</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a id="spring-cloud-dataflow"></a> <a href="https://github.com/spring-cloud/spring-cloud-dataflow">spring-cloud-dataflow</a></p>
</li>
<li>
<p><a id="spring-cloud-dataflow-server-local"></a> <a href="https://github.com/spring-cloud/spring-cloud-dataflow/tree/master/spring-cloud-dataflow-server-local">spring-cloud-dataflow-server-local</a></p>
</li>
<li>
<p><a id="spring-cloud-dataflow-docs"></a> <a href="https://github.com/spring-cloud/spring-cloud-dataflow/blob/master/spring-cloud-dataflow-docs/">spring-cloud-dataflow-docs</a></p>
</li>
<li>
<p><a id="spring-cloud-dataflow-samples"></a> <a href="https://github.com/spring-cloud/spring-cloud-dataflow-samples">spring-cloud-dataflow-samples</a></p>
</li>
<li>
<p><a id="spring-cloud-dataflow-shell"></a> <a href="https://github.com/spring-cloud/spring-cloud-dataflow/blob/master/spring-cloud-dataflow-shell/">spring-cloud-dataflow-shell</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Documentation</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://cloud.spring.io/spring-cloud-dataflow">Quick Start page</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/">Spring Cloud Data Flow Reference Guide</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-cloud-dataflow-samples/docs/current/reference/htmlsingle">Spring Cloud Data Flow Samples</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Pivotal</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">Blog</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://content.pivotal.io/blog/building-flexible-data-pipelines-with-spring-cloud-data-flow-for-pcf">Building Flexible Data Pipelines with Spring Cloud Data Flow for PCF</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Documentation</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="http://docs.pivotal.io/scdf/">Spring CloudÂ® Data Flow for PCF</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a id="all-videos"></a> YouTube videos</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://www.youtube.com/channel/UC7yfnfvEUlXUIfm8rGLwZdA">SpringDeveloper channel</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.youtube.com/watch?v=Z6_ttC33N0U" target="_blank" rel="noopener">Webinar Data Microservices with Spring Cloud Data Flow</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=GqEsgLUwskY" target="_blank" rel="noopener">Orchestrating Data Microservices with Spring Cloud Data Flow - Mark Pollack</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=GaHgRw-3K84" target="_blank" rel="noopener">Spring Tips: Spring Cloud Data Flow</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=uyN8ttlTvUM" target="_blank" rel="noopener">Demo: Spring Cloud Data Flow Shell Tips and Tricks</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=KT_4kVcyfRA" target="_blank" rel="noopener">8 min demo: Composed Tasks in Spring Cloud Data Flow 1.2</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=78CgV46OstI" target="_blank" rel="noopener">Spring Flo for Spring Cloud Data Flow1.0.0M3</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="https://www.youtube.com/channel/UCdJ9hxQzAokvxuTdLUmXkQA">Corby Page channel</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.youtube.com/watch?v=8cqztXVPy6c" target="_blank" rel="noopener">SCDF</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Other articles/ examples</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a id="oA"></a> oA: <a href="https://blog.ik.am/entries/396">Getting Started with Spring Cloud Data Flow on PCF Dev</a></p>
</li>
<li>
<p><a href="http://zoltanaltfatter.com/2017/08/24/streaming-with-spring-cloud-data-flow/">Streaming with Spring Cloud Data Flow</a></p>
</li>
<li>
<p><a href="http://www.baeldung.com/spring-cloud-data-flow-stream-processing">Getting Started with Stream Processing with Spring Cloud Data Flow</a></p>
</li>
<li>
<p><a href="https://labnotes.panderalabs.com/spring-cloud-data-flow-and-docker-kubernetes-99a19f2dbab3">Setting up a Spring Cloud Data Flow sandbox using Docker with Kubernetes</a></p>
</li>
<li>
<p><a href="https://www.e4developer.com/2018/02/23/spring-cloud-data-flow-making-custom-apps-and-shell/">Spring Cloud Data Flow â Making Custom Apps and Using Shell</a></p>
</li>
<li>
<p><a href="https://dzone.com/articles/building-data-pipelines-with-spring-cloud-data-flo">Building Data Pipelines With Spring Cloud Data Flow</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-05-20 22:44:47 WEST
</div>
</div>
</body>
</html>